<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<title>Tiny Attack Bookmarklet</title>
<style>
body{
  max-width: 720px;
}
ul.faq li:nth-child(odd) {
    font-weight: bold;
	padding-top: 3px;
	padding-bottom: 3px;
}
ul.faq li:nth-child(even) {
  list-style-type: none;
}
</style>
<body>

<header>
<h2>Tiny Attack Bookmarklet</h2>
</header>

<main>
<p>Here you can find a bookmarklet that adds some information to your Tiny Attack game as shown below.</p>

<a href="#" onClick="window.open('preview.png');return false;">
<img src="preview.png" alt="Preview" width="640" style="border: 1px solid #000"/>
</a>

<p>There are two ways to use the bookmarklet:</p>
<ul>
<li>
  <p><strong>As a bookmark</strong> (no plugin needed)</p>
  <p>Add this to your bookmarks using right-click:
    <a href="javascript:(function()%7Bfunction%20doIt()%7Bconst%20t%3DJSON.parse%2Ce%3Ddocument%2Cn%3De.documentElement.outerHTML%2Ca%3Dt(n.match(%2F'gameId'%3A%20(%5Cd%2B)%2F)%5B1%5D)%2Co%3Dt(n.match(%2F'cacheId'%3A%20(-%3F%5Cd%2B)%2F)%5B1%5D)%2Ci%3Dt(n.match(%2F'playerId'%3A%20(%5Cd%2B)%2F)%5B1%5D)%2Cc%3Dt(n.match(%2F'coinBase'%3A%20(%5Cd%2B)%2F)%5B1%5D)%2Cs%3Dt(n.match(%2F'coinTurn'%3A%20(%5Cd%2B)%2F)%5B1%5D)%2Cr%3Dt(n.match(%2F'colors'%3A%20(%5C%5B%5B%5E%5C%5D%5D%2B%5C%5D)%2F)%5B1%5D)%2Cd%3Dt(n.match(%2F%2C%20'tile'%3A%20(%5C%7B%5B%5E%5C%7D%5D%2B%5C%7D)%2C%2F)%5B1%5D)%2Cl%3Dt(n.match(%2F%2C%20'unit'%3A%20(%5C%7B%5B%5E%5C%7D%5D%2B%5C%7D)%2C%2F)%5B1%5D)%2Ch%3Dt(n.match(%2Fgame.getMap%5C(%5C).addCoordinates%5C((%5C%7B%5B%5E%5C%7D%5D%2B%5C%7D%5C%7D)%2C%2F)%5B1%5D)%2Cm%3D176%3D%3D%3Di%2Cu%3D5%3D%3D%3D(new%20Date).getMonth()%2Cp%3Dd.data.filter((t%3D%3Et%5B3%5D)).map((t%3D%3Et%5B0%5D))%2Cg%3D%5B%5D%2Cf%3D%5B%5D%2Cy%3D%5B%5D%3Bh.data.forEach((t%3D%3E%7Bconst%20e%3Dt%5B0%5D%2B%22%2C%22%2Bt%5B1%5D%2Cn%3Dt%5B2%5D%3Bp.includes(n)%26%26g.push(e)%2C20%3D%3D%3Dn%3Ff.push(e)%3A7%3D%3D%3Dn%26%26y.push(e)%7D))%3Bconst%5Bb%2Cx%2Ck%2CI%2CT%2CE%5D%3D%5B%22unitId%22%2C%22skinId%22%2C%22coin%22%2C%22title%22%2C%22type%22%2C%22weight%22%5D.map((t%3D%3El.key.indexOf(t)))%2CL%3D%5B%5D%2Cw%3D%5B%5D%3Bl.data.forEach((t%3D%3E%7BL.push(t%5Bb%5D)%2Cw%5Bt%5Bb%5D%5D%3D%7Bcost%3At%5Bk%5D%2Ctitle%3At%5BI%5D%2CskinId%3At%5Bx%5D%2CtypeWeight%3At%5BT%5D%2Bt%5BE%5D%7D%7D))%3Bconst%20M%3D%5B%22LandLight%22%2C%22LandHeavy%22%2C%22AirLight%22%2C%22AirHeavy%22%2C%22WaterLight%22%2C%22WaterHeavy%22%2C%22WaterStealth%22%5D%3Bfunction%20O(t%2Ce)%7Bt.appendChild(e)%7Dfunction%20S(t)%7Breturn%20e.createElement(t)%7Dfunction%20v(t%2Cn%2Ca)%7Bconst%20o%3DS(%22td%22)%3Bo.title%3Dn%3F%3Ft%2CO(o%2Ce.createTextNode(%22number%22%3D%3Dtypeof%20t%3Ft.toLocaleString()%3At))%3Bconst%20i%3Do.style%3Breturn%20i.color%3Da%3F%3F%22%23fff%22%2Ci.fontSize%3D%2214px%22%2Ci.fontWeight%3D%22bolder%22%2Ci.textAlign%3D%22center%22%2Ci.padding%3D%224px%208px%22%2Co%7DL.sort(((t%2Ce)%3D%3E%7Bconst%20n%3DM.indexOf(w%5Bt%5D.typeWeight)%2Ca%3DM.indexOf(w%5Be%5D.typeWeight)%3Breturn%20n%3D%3D%3Da%3Fw%5Bt%5D.cost-w%5Be%5D.cost%3An-a%7D))%2Cfetch(%22https%3A%2F%2Fcdn.tinyattack.com%2Fgame%2F%22%2Ba%2B%22%2Fpublic.json%22).then((t%3D%3Et.json())).then((t%3D%3E%7Bconst%20n%3Dt.player.data%2Ca%3Dt.player.key.indexOf(%22coin%22)%2Ci%3Dn.length%2Cd%3D%5B%5D%3Bfor(let%20t%3D0%3Bt%3Ci%3Bt%2B%2B)d%5Bt%2B1%5D%3D%7Bcoin%3An%5Bt%5D%5Ba%5D%2Cincome%3As%2Cstrength%3A0%2Cpotential%3A0%2Cunits%3A%5B%5D%7D%2CL.forEach((e%3D%3Ed%5Bt%2B1%5D.units%5Be%5D%3D%7Bcount%3A0%2Chealth%3A0%7D))%3Bconst%5Bl%2Ch%2Cp%2Cb%2Cx%2Ck%5D%3D%5B%22x%22%2C%22y%22%2C%22unitId%22%2C%22unitHealth%22%2C%22unitPlayer%22%2C%22tilePlayer%22%5D.map((e%3D%3Et.coordinate.key.indexOf(e)))%3Bt.coordinate.data.forEach((t%3D%3E%7Bconst%20e%3Dt%5Bp%5D%2Cn%3Dt%5Bb%5D%2Ca%3Dt%5Bx%5D%2Co%3Dt%5Bk%5D%2Ci%3Dt%5Bl%5D%2B%22%2C%22%2Bt%5Bh%5D%3Bo%26%26g.includes(i)%26%26(d%5Bo%5D.income%2B%3Dc)%2Ce%26%26n%26%26a%26%26(d%5Ba%5D.strength%2B%3Dw%5Be%5D.cost*n%2F10%2Cd%5Ba%5D.potential%2B%3Dw%5Be%5D.cost%2Cd%5Ba%5D.units%5Be%5D.count%2B%3D1%2Cd%5Ba%5D.units%5Be%5D.health%2B%3Dn%2C40%3D%3D%3De%26%26(f.includes(i)%3Fd%5Ba%5D.income%2B%3DMath.floor(75*n%2F10)%3Ay.includes(i)%26%26(d%5Ba%5D.income%2B%3DMath.floor(25*n%2F10))))%7D))%3Bconst%20I%3DL.filter((t%3D%3Ed.some((e%3D%3Ee.units%5Bt%5D.count%3E0))))%2CT%3DS(%22table%22)%3BT.style.marginTop%3D%224px%22%2CT.style.marginBottom%3D%228px%22%3Bconst%20E%3DS(%22tr%22)%3Bm%26%26O(E%2Cv(%22%24%22%2C%22%24%22%2C%22%23000%22))%2CI.forEach((t%3D%3E%7Bconst%20e%3DS(%22td%22)%2Cn%3DS(%22img%22)%3Bn.alt%3Dn.title%3Dw%5Bt%5D.title%2Cn.width%3D%2248%22%2Cn.height%3D%2251%22%3Bconst%20a%3Du%3FMath.floor(12*Math.random()%2B1)%3A0%3Bn.src%3D%22https%3A%2F%2Fcdn.tinyattack.com%2Fimg%2Fskin%2F%22%2Bw%5Bt%5D.skinId%2B%22%2F%22%2Ba%2B%22.png%3Ft%3D0%22%2CO(e%2Cn)%2CO(E%2Ce)%7D))%2CO(E%2Cv(%22INC%22%2C%22Income%22%2C%22%23000%22))%2CO(E%2Cv(%22STR%22%2C%22Current%20Army%20Strength%22%2C%22%23000%22))%2CO(E%2Cv(%22POT%22%2C%22Army%20Potential%22%2C%22%23000%22))%3Bconst%20M%3Dv(%22STR%22%2C%22STR%2FPOT%22%2C%22%23000%22)%3BM.innerHTML%3D%22%3Csup%3ESTR%3C%2Fsup%3E%26frasl%3B%3Csub%3EPOT%3C%2Fsub%3E%22%2CO(E%2CM)%2CO(T%2CE)%2Cd.forEach(((t%2Ce)%3D%3E%7Bconst%20n%3DS(%22tr%22)%3Bm%26%26O(n%2Cv(t.coin))%2Cn.style.backgroundColor%3Dr%5Be%5D.hex.darker%2Cn.style.border%3D%221px%20solid%20black%22%2CI.forEach((e%3D%3E%7BO(n%2Cv(t.units%5Be%5D.count))%7D))%2CO(n%2Cv(t.income))%2CO(n%2Cv(Math.round(t.strength)))%2CO(n%2Cv(t.potential))%2CO(n%2Cv(0%3D%3D%3Dt.potential%3F%22-%22%3AMath.round(100*t.strength%2Ft.potential)%2B%22%25%22))%2CO(T%2Cn)%7D))%3Bconst%20W%3DS(%22a%22)%3BW.href%3D%22https%3A%2F%2Fta-bs.github.io%2F%3Fcache%3D%22%2Bo%2CW.target%3D%22_blank%22%2CW.classList.add(%22btn%22%2C%22btn-primary%22%2C%22w-lg-auto%22)%3Bconst%20B%3DS(%22span%22)%3BB.classList.add(%22fa%22%2C%22fa-external-link-alt%22)%2CO(W%2CB)%2CO(W%2Ce.createTextNode(%22%20Open%20Battle%20Simulator%22))%3Bconst%20C%3DS(%22button%22)%3BC.classList.add(%22btn%22%2C%22btn-primary%22%2C%22w-lg-auto%22)%2CC.addEventListener(%22click%22%2C(()%3D%3E%7BC.disabled%3D!0%2CdoIt()%7D))%3Bconst%20H%3DS(%22span%22)%3BH.classList.add(%22fa%22%2C%22fa-redo%22)%2CO(C%2CH)%2CO(C%2Ce.createTextNode(%22%20Refresh%22))%3Bconst%20N%3DS(%22div%22)%3BO(N%2CW)%2CO(N%2Ce.createTextNode(%22%20%22))%2CO(N%2CC)%3Bconst%20P%3DS(%22div%22)%3BP.id%3D%22tabsbm%22%2CP.style.marginBottom%3D%2212px%22%2CO(P%2CT)%2CO(P%2CN)%3Bconst%20A%3De.getElementById(%22tabsbm%22)%2CR%3De.getElementById(%22game%22)%2Cj%3DR.parentElement%3BA%26%26j.removeChild(A)%2Cj.insertBefore(P%2CR)%7D))%7Dwindow.location.href.startsWith(%22https%3A%2F%2Fwww.tinyattack.com%2Fgame%2Fview.html%3FgameId%3D%22)%26%26doIt()%3B%7D)()%3B">
      Tiny Attack Bookmarklet
    </a>
  </p>
  <p>Then use the bookmark whenever you are in a Tiny Attack game.</p>
  <p>This does not need any plugin in your browser, but you have to use the bookmark manually every time.</p>
  <p>Also, you will not notice if improved versions of the bookmarklet are released.</p>
</li>
<li>
  <p><strong>As a userscript</strong> (requires plugin)</p>
  <p>With a userscript, you can have the bookmarklet be applied automatically in all your games. In addition, you can use the integrated update feature.</p>
  <p>First, you need to have a userscript plugin installed in your browser, for example Greasemonkey, Tampermonkey, or Violentmonkey.</p>
  <p>Then you can install the bookmarklet: <a href="tabm.user.js">Install userscript</a></p>
</li>
</ul>


<section>
<h3>FAQ</h3>
<ul class="faq">
    <li>What does 'INC' mean?</li>
    <li>'INC' is the income of that player.</li>
    <li>What does 'STR' mean?</li>
    <li>'STR' is the current army strength, that is the sum of the cost of each unit, reduced proportionally for damaged units. Example: A Striker (which costs 200) with 6 health contributes a value of 120 to STR.</li>
    <li>What does 'POT' mean?</li>
    <li>'POT' is the army potential, that is the strength the army will have when all units are at full health.</li>
	<li>The numbers do not update properly!</li>
    <li>Everything that can still be undone (like building units) is not reflected in the numbers.</li>
    <li>Is it safe?</li>
    <li>The bookmarklet runs in your browser. I did not do anything malicious, but you'll have to trust me.</li>
</ul>
</section>
</main>

</body>
</html>